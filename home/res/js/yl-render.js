"use strict";YL.render=function(data){$(window).on("message",function(t){var n=t.originalEvent.data;if(!($.inArray(n.type,["ylui-pong","ylui-eval","ylui-emit"])<0)){var t=n.from,i=t[0],s=YL.vue.wins,e=s[i];if(function(t){var e=t[0],n=t[1],t=YL.vue.wins[e];if(t){if(t.secrete===n)return!0;YL.vue.winClose(e),YL.msg(YL.lang("SecurityRisk"),YL.lang("SecurityRiskDetail"))}return!1}(t))switch(n.type){case"ylui-pong":e.pong=Date.now();break;case"ylui-eval":var o=YL.child[n.eval.method].call(YL.child,n.eval.data,i);window.frames[i]&&window.frames[i].postMessage({type:"ylui-eval",result:o,session:n.session},"*");break;case"ylui-emit":var o=n.emit.target,r=[];if("string"==typeof o)r.push(o);else if(Yuri2.isArray(o))r=o;else if(!0===o)for(var a in s)r.push(a);var u=Yuri2.parseURL(e.urlOrigin);r.forEach(function(t){var e=Yuri2.parseURL(s[t].urlOrigin);window.frames[t]&&window.frames[t].postMessage({type:"ylui-event",event:n.emit.event,target:r,data:n.emit.data,session:n.session,from:i,sameOrigin:u.protocol===e.protocol&&u.host===e.host&&u.port===e.port},"*")})}}}),document.body.onbeforeunload=function(t){var e;YL.static.beforeOnloadEnable&&(e=YL.lang("BeforeUnload"),window.event?window.event.returnValue=e:t.returnValue=e)},YL.vue=new Vue({el:"#yl",data:data,components:{GridLayout:VueGridLayout.GridLayout,GridItem:VueGridLayout.GridItem},created:function(){this.initRuntime(!0)},methods:{contextMenuAddTo:function(t){function n(){YL.util.simpleMsg(YL.lang("Added"))}var i=Yuri2.jsonDeepCopy(t),s=[];return this.tiles.forEach(function(t,e){s.push([YL.util.getStrFa("square")+t.title,function(){YL.addTile(i,e),n()},!YL.static.changeable])}),[YL.util.getStrFa("copy")+YL.lang("AddTo"),[[YL.util.getStrFa("desktop")+YL.lang("DesktopIcons"),function(){YL.addShortcut(i),n()},!YL.static.changeable],[YL.util.getStrFa("list-ul")+YL.lang("MainMenu"),function(){YL.addMenuItem(i),n()},!YL.static.changeable],[YL.util.getStrFa("sliders")+YL.lang("Sidebar"),function(){YL.addSidebarBtn(i),n()},!YL.static.changeable],"|","<span style='color: darkgray'>"+YL.util.getStrFa("square")+YL.lang("Tiles")+"</span>"].concat(s)]},contextMenuUninstall:function(e){var n=this;return[YL.util.getStrFa("trash")+YL.lang("Uninstall"),function(t){YL.util.simpleConfirm(Yuri2.template(YL.lang("UninstallConfirm"),n.apps[e].title),function(){YL.uninstall(e)&&YL.util.simpleMsg(YL.lang("UninstallCompleted"))})},!YL.static.changeable]},contextMenuOpen:function(e){var n=this;return[YL.util.getStrFa("play-circle")+YL.lang("Open"),[[YL.util.getStrFa("window-restore")+YL.lang("Normal"),function(t){n.appOpen(e.app,Yuri2.jsonMerge(e,{openMode:"normal"}),e)}],[YL.util.getStrFa("window-maximize")+YL.lang("Maximize"),function(t){n.appOpen(e.app,Yuri2.jsonMerge(e,{openMode:"max"}),e)}],[YL.util.getStrFa("window-minimize")+YL.lang("Minimize"),function(t){n.appOpen(e.app,Yuri2.jsonMerge(e,{openMode:"min"}),e)}],[YL.util.getStrFa("paper-plane")+YL.lang("Outer"),function(t){n.appOpen(e.app,Yuri2.jsonMerge(e,{openMode:"outer"}),e)}]]]},onResize:function(){var t=this,e=Yuri2.getClientSize();t.runtime.clientSize.width=e.width,t.runtime.clientSize.height=e.height,t.runtime.desktopSize.width=e.width,t.runtime.desktopSize.height=e.height-40,t.runtime.isSmallScreen=e.width<=768,t.runtime.isHorizontalScreen=e.width>e.height,t.runtime.startMenu.width=(e.width>t.startMenu.width&&!t.runtime.isSmallScreen?t.startMenu:e).width,t.runtime.startMenu.height=(t.runtime.desktopSize.height>t.startMenu.height&&!t.runtime.isSmallScreen?t.startMenu:t.runtime.desktopSize).height;var n=t.runtime.startMenu.width-(t.runtime.isSmallScreen?80:328),i=1,i=n<=460?1:n<=769?2:n<=1024?3:4;t.runtime.tilesGroupNum=i;for(var s=0;s<1e3;s++)if((n-12*i)/i<6*(s+4)){s--;break}t.runtime.tileSize=s,t.runtime.tilesWidth=6*(s+4),t.runtime.shortcutWidth=t.runtime.isSmallScreen?56:68,t.runtime.shortcutHeight=t.runtime.isSmallScreen?70:90,t.runtime.shortcutsGrid.x=parseInt(t.runtime.desktopSize.width/t.runtime.shortcutWidth),t.runtime.shortcutsGrid.y=parseInt(t.runtime.desktopSize.height/t.runtime.shortcutHeight),t.emitWinEvent(0,"resize",{width:t.runtime.desktopSize.width,height:t.runtime.desktopSize.height})},initRuntime:function(t){var s=this,e=s.onResize;e(),t&&$(window).resize(e),t&&setInterval(function(){var t=new Date,e=(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours()),n=t.getMinutes();n<10&&(n="0"+n),s.runtime.time=e+":"+n,s.runtime.date=t},1e3),t&&this.$nextTick(function(){for(var n=["#yl .tiles-box","#yl .startMenu .menu","#yl .center .msgs"],t=0;t<n.length;t++)$(n[t]).niceScroll({cursorcolor:"#ffffff30",cursorwidth:"4px",cursorborder:"none",grabcursorenabled:!1});setInterval(function(){for(var t=0;t<n.length;t++){var e=n[t];try{$(e).getNiceScroll().resize()}catch(e){}}},500),$("#yl").css({opacity:1,display:"block"})}),t&&setInterval(function(){var t,e,n,i;s.configs.wallpaperSlide&&(e=60*s.configs.wallpaperSlideItv*1e3,n=s.configs.wallpaperSlideTime,t=s.configs.wallpaperSlideIndex,e+n<(i=Date.now())&&(s.configs.wallpaperSlideTime=i,n=(e=s.configs.wallpapers).length,i=0,s.configs.wallpaperSlideRandom?i=YL.util.randInt(0,n-1):n<=(i=t+1)&&(i=0),e[i]&&(s.configs.wallpaper=e[i].image,s.configs.wallpaperSlideIndex=i)))},1e3),Yuri2.isIE()&&(s.runtime.isIE=!0,YL.static.WarningPerformanceInIE&&setTimeout(function(){YL.msg(YL.lang("WarningPerformanceInIETitle"),YL.lang("WarningPerformanceInIEContent"))},2e3));var n,e=new Image,i=this.configs.wallpaper;e.src=i,e.onload=function(){s.runtime.wallpaper=i,s.configs.autoThemeColor&&s.backgroundToThemeColor()},s.backgroundUpdateScale(),t&&(n="",setInterval(function(){try{var t=JSON.stringify(YL.export());t!==n&&(n=t,localStorage.setItem(YL.static.localStorageName,t),s.emitWinEvent(0,"dataChanged"))}catch(t){YL.debug(t)}},1e3)),t&&(o=function(t){(t=t||window.event).ctrlKey&&116===(t.which||t.keyCode)?YL.static.beforeOnloadEnable=!1:116===(t.which||t.keyCode)&&(t.preventDefault?t.preventDefault():(t.keyCode=0,t.returnValue=!1),s.runtime.winActive?s.winRefresh(s.runtime.winActive):s.flash())},document.addEventListener?document.addEventListener("keydown",o,!1):document.attachEvent("onkeydown",o)),t&&setInterval(function(){var t,e=Date.now();for(t in s.wins){var n=s.wins[t];n.childSupport=n.pong&&e-n.pong<500}},300);var o=function(){var t,e=[];for(t in s.apps)0<s.apps[t].autoRun&&e.push(t);e.sort(function(t,e){return s.apps[e].autoRun-s.apps[t].autoRun}),e.forEach(function(t){var e=s.appOpen(t,{});s.apps[t].plugin&&s.runtime.isSmallScreen&&s.$nextTick(function(){s.winMinimize(e)})})};t?YL.onReady(o):o(),this.ready=!0},setWithID:function(t,e,n,i){do{var s=!0===i?n+Yuri2.randInt(1e8,999999999):n+YL.util.getID()}while(void 0!==t[s]);return this.$set(t,s,e),s},emitWinEvent:function(e,n,i){var t,s=[];for(t in this.wins)s.push(t);this.$nextTick(function(){s.forEach(function(t){window.frames[t].postMessage&&window.frames[t].postMessage({type:"ylui-event",event:n,target:s,data:i,session:null,from:e,sameOrigin:!1},"*")})})},flash:function(){var t=this;t.runtime.shortcutsShow=!1,setTimeout(function(){t.runtime.shortcutsShow=!0},200),t.runtime.customTileRandomToken=YL.util.randInt(1e3,9999)},appOpen:function appOpen(id,options,source){var that=this;options=options||{};var app="string"==typeof id?this.apps[id]:id,appMerge=Yuri2.jsonMerge(app,options);if(this.hideOpens(),appMerge.single)for(var i in this.wins){var w=this.wins[i];if(w.single&&w.app===id)return that.winSetActive(i),void that.winShow(i)}if(appMerge.url)if(this.runtime.winOpened>=this.configs.openMax)YL.util.simpleMsg(Yuri2.template(YL.lang("MaxWinsReached"),this.configs.openMax));else{this.runtime.winOpenCounter++;var dx=parseInt(this.runtime.winOpenCounter%10)*this.runtime.clientSize.height*.01,evalNum=function evalNum(str){var rel=0;if(isNaN(str))try{/^[\dxy+\-*\/()\s.]*$/.test(str)||(str="600");var query="var x=YL.vue.runtime.clientSize.width;var y=YL.vue.runtime.clientSize.height-40;"+str,rel=eval(query)}catch(e){YL.debug(e)}else rel=str;return parseInt(rel)},win={app:id,state:"normal",min:!1,addressBar:!0,style:{position:{x:evalNum(app.position.x)+(app.position.autoOffset?dx:0),y:evalNum(app.position.y)+(app.position.autoOffset?dx+80:0),left:app.position.left,top:app.position.top},size:{width:evalNum(app.size.width),height:evalNum(app.size.height)}},drag:{mDownPosition:!1,mDownSize:!1,x:0,y:0},oldStyle:{position:{left:0,top:0},size:{width:0,height:0}},source:source,resizable:!0,history:{pos:-1,urls:[]},data:{},pong:null,childSupport:!1,init:!0},win=Yuri2.jsonMerge(win,appMerge);if(win.style=Yuri2.jsonDeepCopy(win.style),win.style.index=YL.util.getBiggerWinZIndex(),win.url=YL.util.urlParams(win.url,win.params,win.hash),win.urlRandomToken&&(win.url=YL.util.updateUrlRandomToken(win.url)),"outer"!==win.openMode){win.urlOrigin=win.url,win.urlBar=win.url;var winID=this.setWithID(this.wins,win,"win-",!0),secrete=Math.random();switch(win.idIframe=winID+"iframe-",win.secrete=secrete,this.emitWinEvent(winID,"open",null),win.openMode){case"max":this.winMaximize(winID);break;case"min":this.winMinimize(winID)}return win.min||(this.runtime.winActive=winID),that.$nextTick(function(){var t=setInterval(function(){$("#"+winID).length<=0?clearInterval(t):window.frames[winID].postMessage&&window.frames[winID].postMessage({type:"ylui-ping",id:winID,secrete:secrete,itv:t,data:win.data},"*")},500),e=$("#"+win.idIframe)[0];YL.util.iframeOnClick.track(e,function(){0===Object.getOwnPropertyNames(YL.util._iframe_click_lock_children).length&&(that.winSetActive(winID),ContextMenu._removeContextMenu())},winID),win.min||e.focus();function n(){var t=(new Date).getTime();setTimeout(function(){win.init=!1},1e3<t-i?0:1e3)}var i=(new Date).getTime();e.attachEvent?e.attachEvent("onload",n):e.onload=n}),that.runtime.isSmallScreen&&!win.plugin&&win.resizable&&that.winMaximize(winID),setTimeout(function(){win.init=!1},1e4),winID}window.open(win.url)}},tileStyle:function(t){function e(t){return t*(n+4)-4}var n=this.runtime.tileSize,i=t.w,s=t.h,t=e(Math.min(i,s)/1.5);return{width:t+"px",height:t+"px",top:(e(s)-t)/2+"px",left:(e(i)-t)/2+"px","line-height":t+"px","font-size":t/2+"px"}},winIsMin:function(t){return this.wins[t].min},winShow:function(t){this.wins[t].min=!1},winShowToggle:function(t){t=this.wins[t];t.min=!t.min},winClose:function(t){this.wins[t]&&(this.$delete(this.wins,t),this.emitWinEvent(t,"close",null),this.findNewActive())},winMaximize:function(t){t=this.wins[t];t.resizable?(t.state="max",t.oldStyle.position.y=t.style.position.y,t.style.position.y=t.addressBar?80:40,t.oldStyle.position.x=t.style.position.x,t.style.position.x=0,t.oldStyle.size.width=t.style.size.width,t.style.size.width=this.runtime.desktopSize.width,t.oldStyle.size.height=t.style.size.height,t.style.size.height=this.runtime.desktopSize.height-(t.addressBar?80:40)):YL.util.simpleMsg(YL.lang("AttentionNoResize"))},winRestore:function(t){t=this.wins[t];t.state="normal",t.style.position.y=t.oldStyle.position.y,t.style.position.x=t.oldStyle.position.x,t.style.size.width=t.oldStyle.size.width,t.style.size.height=t.oldStyle.size.height},winMinimize:function(t){this.wins[t].min=!0,this.findNewActive()},winSetCenter:function(t){var e,n=this.wins[t];this.winShow(t),n.resizable?(n.state="normal",e=this.runtime.desktopSize.width,t=this.runtime.desktopSize.height,n.style.size.width=.8*e,n.style.size.height=.8*t-80,n.style.position.y=.1*t+80,n.style.position.x=.1*e):YL.util.simpleMsg(YL.lang("AttentionNoResize"))},winTitleMouseDown:function(n,i){var s,o,r,a,t,u;3!==i.which&&(s=!i.changedTouches,t=(o=function(t){var e,n={x:0,y:0};return i.changedTouches?(e=t.changedTouches||t.originalEvent.changedTouches,n.x=e[0].pageX,n.y=e[0].pageY):(n.x=t.pageX,n.y=t.pageY),n})(i),(a=(r=this).wins[n]).drag.x=t.x,a.drag.y=t.y,a.drag.mDownPosition=!0,t=function t(e){a.drag.mDownPosition&&(a.drag.mDownPosition=!1,r.runtime.drag=!1,s?($(document).unbind("mousemove",u),$(document).unbind("mouseup",t)):($(document).unbind("touchmove",u),$(document).unbind("touchend",t)))},u=function(t){var e;a.drag.mDownPosition&&(r.runtime.drag=!0,t=(e=o(t)).x,e=e.y,"max"===a.state&&2<e-a.drag.y&&r.winRestore(n),a.style.position.x+=a.style.position.left?t-a.drag.x:a.drag.x-t,a.style.position.y+=a.style.position.top?e-a.drag.y:a.drag.y-e,a.drag.x=t,a.drag.y=e)},s?($(document).mouseup(t),$(document).mousemove(u)):($(document).on("touchend",t),$(document).on("touchmove",u)))},winTitleDblclick:function(t){var e=this.wins[t];e.plugin||("max"===e.state?this.winRestore(t):this.winMaximize(t))},winResizeMouseDown:function(t,e){var n=this,i=this.wins[t];i.drag.x=e.pageX,i.drag.y=e.pageY,i.drag.mDownSize=!0;var e=function t(e){i.drag.mDownSize&&(i.drag.mDownSize=!1,n.runtime.drag=!1,$(document).unbind("mouseup",t),$(document).unbind("mousemove",s))},s=function(t){var e;i.drag.mDownSize&&(n.runtime.drag=!0,e=t.pageX,t=t.pageY,i.style.size.width+=e-i.drag.x,200<i.style.size.width||(i.style.size.width=200),i.style.size.height+=t-i.drag.y,84<i.style.size.height||(i.style.size.height=84),i.drag.x=e,i.drag.y=t)};$(document).mouseup(e),$(document).mousemove(s)},winSetActive:function(t){var e=Date.now();e-this.runtime.winActiveTime<200||(this.runtime.winActiveTime=e,this.wins[t].style.index=YL.util.getBiggerWinZIndex(),this.runtime.winActive=t,this.startMenu.open=!1,this.drawer=null,this.center.open=!1)},winStyle:function(t){t=this.wins[t];return{width:t.style.size.width+"px",height:t.style.size.height+"px",top:t.style.position.top?t.style.position.y+"px":"auto",left:t.style.position.left?t.style.position.x+"px":"auto",bottom:t.style.position.top?"auto":t.style.position.y+"px",right:t.style.position.left?"auto":t.style.position.x+"px","z-index":t.style.index+(t.background?-500:0)}},winInitIconStyle:function(t){t=this.wins[t],t=Math.min(t.style.size.width,t.style.size.height)/4;return{"font-size":t+"px","line-height":t+"px",width:1.5*t+"px"}},winClass:function(t){var e=this.wins[t];return{active:t===this.runtime.winActive&&!this.winIsMin(t),plugin:e.plugin,"addressBar-hidden":!e.addressBar}},winTaskClick:function(t){this.wins[t];this.winIsMin(t)||this.startMenu.open||this.drawer?(this.winShow(t),this.winSetActive(t)):this.runtime.winActive===t?(this.winMinimize(t),this.findNewActive()):this.winSetActive(t)},winRefresh:function(t){var e=this.wins[t],n=e.urlBar;this.winJump(t,e.urlRandomToken?YL.util.updateUrlRandomToken(n):n)},winHome:function(t){var e=this.wins[t],n=e.urlOrigin;this.winJump(t,e.urlRandomToken?YL.util.updateUrlRandomToken(n):n)},winJump:function(t,e){var n=this.wins[t];n.url=n.urlBar="about:blank",setTimeout(function(){n.url=n.urlBar=e},200)},winContextMenu:function(t,e){var n=this,i=this.wins[t],s=[[YL.util.getStrFa("refresh")+YL.lang("Refresh"),function(){n.winRefresh(t)}]];i.addressBar?s.push([YL.util.getStrFa("location-arrow")+YL.lang("HideAddressBar"),function(){i.addressBar=!1}]):s.push([YL.util.getStrFa("location-arrow")+YL.lang("DisplayAddressBar"),function(){i.addressBar=!0}]),s.push([YL.util.getStrFa("magic")+YL.lang("CollectAsApplication"),function(){layer.prompt({title:YL.lang("AttentionEnterAppName"),formType:0,value:Yuri2.parseURL(i.url).host,maxlength:32,skin:"yl",zIndex:19930012},function(t,e){layer.close(e);e=YL.util.getAppDataTemplate();e.url=YL.util.removeUrlRandomToken(i.url),e.title=t,e.icon.type="str",e.icon.content=t;t="app-"+YL.util.getID();YL.addApp(t,e),YL.addShortcut(t),YL.addMenuItem(t),YL.util.simpleMsg(YL.lang("Added"))})},!YL.static.changeable]),s.push("|");var o=[];o.push(YL.util.getStrFa("arrows")+Yuri2.template("${0}px * ${1}px",parseInt(i.style.size.width),parseInt(i.style.size.height))),o.push([YL.util.getStrFa("window-restore")+YL.lang("CentreAdjustment"),function(){n.winSetCenter(t),n.winSetActive(t)}]),n.winIsMin(t)?o.push([YL.util.getStrFa("clone")+YL.lang("DisplayWindow"),function(){n.winShow(t)}]):o.push([YL.util.getStrFa("window-minimize")+YL.lang("Minimize"),function(){n.winMinimize(t)}]),!i.plugin&&"normal"===i.state&&i.resizable&&o.push([YL.util.getStrFa("window-maximize")+YL.lang("Maximize"),function(){n.winShow(t),n.winMaximize(t)}]),i.plugin||"max"!==i.state||o.push([YL.util.getStrFa("window-restore")+YL.lang("Restore"),function(){n.winRestore(t)}]),o.push("|"),i.style.position.left?o.push([YL.util.getStrFa("angle-double-right")+YL.lang("AlignRight")+Yuri2.template(" (${0}px)",parseInt(i.style.position.x)),function(){i.style.position.left=!i.style.position.left}]):o.push([YL.util.getStrFa("angle-double-left")+YL.lang("AlignLeft")+Yuri2.template(" (${0}px)",parseInt(i.style.position.x)),function(){i.style.position.left=!i.style.position.left}]),i.style.position.top?o.push([YL.util.getStrFa("angle-double-down")+YL.lang("AlignBottom")+Yuri2.template(" (${0}px)",parseInt(i.style.position.y)),function(){i.style.position.top=!i.style.position.top}]):o.push([YL.util.getStrFa("angle-double-up")+YL.lang("AlignTop")+Yuri2.template(" (${0}px)",parseInt(i.style.position.y)),function(){i.style.position.top=!i.style.position.top}]),s.push([YL.util.getStrFa("windows")+YL.lang("WindowPosition"),o]),s.push([YL.util.getStrFa("paper-plane")+YL.lang("OpenOuter"),function(){window.open(i.url)}]),i.source&&(s.push([YL.util.getStrFa("crop")+YL.lang("RememberSizeAndPosition"),function(){i.source.style={},i.source.style.position={},i.source.style.size={},i.source.style.position.x=i.style.position.x,i.source.style.position.y=i.style.position.y,i.source.style.position.left=i.style.position.left,i.source.style.position.top=i.style.position.top,i.source.style.position.autoOffset=!1,i.source.style.size.height=i.style.size.height,i.source.style.size.width=i.style.size.width,YL.util.simpleMsg(YL.lang("Recorded"))},!YL.static.changeable]),i.source.style&&s.push([YL.util.getStrFa("crop")+YL.lang("ResetSizeAndPosition"),function(){delete i.source.style},!YL.static.changeable])),i.plugin&&(s.push("|"),i.background?s.push([YL.util.getStrFa("sort-up")+YL.lang("PutForeground"),function(){i.background=!1}]):s.push([YL.util.getStrFa("sort-down")+YL.lang("PutBackground"),function(){i.background=!0}])),s.push("|"),s.push([YL.util.getStrFa("close")+YL.lang("Close"),function(){n.winClose(t)}]),ContextMenu.render(e,s,this,"light")},findNewActive:function(){var t,e=null,n=0;for(t in this.wins){var i=this.wins[t];!i.min&&i.style.index>n&&(n=i.style.index,e=t)}this.runtime.winActive=e},winHideAll:function(){for(var t in this.wins){t=this.wins[t];t.plugin||(t.min=!0)}},winShowAll:function(){for(var t in this.wins){t=this.wins[t];t.plugin||(t.min=!1)}},winCloseAll:function(){for(var t in this.wins)this.wins[t].plugin||this.$delete(this.wins,t)},menuItemClose:function(t){var e,n=t||this.startMenu.menu;for(e in n){var i=n[e];i.children&&(i.open=!1,this.menuItemClose(i))}},menuClose:function(){this.startMenu.open=!1,this.menuItemClose()},showDesktop:function(){this.winHideAll(),this.hideOpens()},badgeText:function(t){return isNaN(t)?t:99<t?"99+":parseInt(t)},drawerStyle:function(){return{top:"0px",left:"0px"}},hideOpens:function(){this.drawer=null,this.menuClose(),this.center.open=!1,this.runtime.pluginIconsOpen=!1,this.runtime.CalendarOpen=!1},desktopMouseDown:function(t){this.hideOpens(),t&&this.emitWinEvent(0,"desktopMouseDown",{x:t.x,y:t.y})},desktopMouseUp:function(t){this.hideOpens(),t&&this.emitWinEvent(0,"desktopMouseUp",{x:t.x,y:t.y})},desktopClick:function(t){this.hideOpens(),t&&this.emitWinEvent(0,"desktopClick",{x:t.x,y:t.y})},desktopContextMenu:function(t){var e=this;e.hideOpens();var n=[[YL.util.getStrFa("refresh")+YL.lang("Refresh"),function(){e.flash()}],"|",[YL.util.getStrFa("desktop")+YL.lang("DisplayDesktop"),function(){e.showDesktop()}],[YL.util.getStrFa("credit-card")+YL.lang("Personalization"),[[YL.util.getStrFa("paint-brush")+YL.lang("ThemeColor"),function(){YL.open("yl-system",{data:{nav:"colors"}})},!YL.static.changeable],[YL.util.getStrFa("picture-o")+YL.lang("Wallpaper"),function(){YL.open("yl-system",{data:{nav:"wallpaper"}})},!YL.static.changeable]]],[YL.util.getStrFa("cog")+YL.lang("SystemOptions"),function(){YL.open("yl-system")},!YL.static.changeable],"|",[YL.util.getStrFa("object-group")+YL.lang("FullScreen"),function(){YL.util.enableFullScreen()}],[YL.util.getStrFa("object-ungroup")+YL.lang("NormalScreen"),function(){YL.util.disableFullScreen()}],[YL.util.getStrFa("circle-o-notch")+YL.lang("Reload"),function(){YL.f5()}],"|",[YL.util.getStrFa("info-circle")+YL.lang("AboutUs"),function(){YL.aboutUs()}]];ContextMenu.render(t,n,this,"light")},desktopMouseMove:function(t){this.emitWinEvent(0,"desktopMouseMove",{x:t.x,y:t.y})},shortcutOpen:function(t,e){var n=Date.now();!t||20<t.drag.moved||n-this.runtime.shortcutOpenedAt<500||(t.children?this.drawer=e:this.appOpen(t.app,t,t),this.runtime.shortcutOpenedAt=Date.now(),YL.debug(YL.lang("OpenIcons")+":"+t.title))},shortcutGrid:function(t){return{x:parseInt(t/this.runtime.shortcutsGrid.y),y:parseInt(t%this.runtime.shortcutsGrid.y)}},shortcutPosition:function(t,e){var n=this.shortcutGrid(t),t=(null===e?this.shortcuts:this.shortcuts[e].children)[t];return{x:n.x*this.runtime.shortcutWidth+t.drag.left,y:n.y*this.runtime.shortcutHeight+t.drag.top}},shortcutStyle:function(t,e){e=this.shortcutPosition(t,e);return{left:e.x+"px",top:e.y+"px"}},shortcutClass:function(t,e,n){return{move:e.drag.mDown,insert:this.runtime.shortcutInsert===t&&!n,over:this.runtime.shortcutOver===t&&!n,cut:this.shortcutCutOutFromDrawer(e)}},shortcutMouseDown:function(o,r,i){var a,u,s,h,l,c,p,t,d;i.which&&1!==i.which||(a=!i.changedTouches,u=Date.now(),t=(s=function(t){var e,n={x:0,y:0};return i.changedTouches?(e=t.changedTouches||t.originalEvent.changedTouches,n.x=e[0].pageX,n.y=e[0].pageY):(n.x=t.pageX,n.y=t.pageY),n})(i),h=this,(c=((l=null!==r)?h.shortcuts[r].children:h.shortcuts)[o]).drag.mDown=!0,c.drag.x=t.x,c.drag.y=t.y,c.drag.moved=0,p=function(s){var o,r,a=h.shortcutPosition(s,null),u=!1,l=!1,c=!1;return h.shortcuts.forEach(function(t,e){var n,i;e!==s&&(n=(i=h.shortcutPosition(e,null)).x-a.x,i=i.y-a.y,Math.abs(n)<h.runtime.shortcutWidth/4&&Math.abs(i)<h.runtime.shortcutHeight/2&&(o=e,u=!0,l=(r=i)<.3*-h.runtime.shortcutHeight,c=Math.abs(i)<.3*h.runtime.shortcutHeight))}),{on:u,id:o,by:r,insert:l,over:c}},t=function t(e){if(c.drag.mDown){if(c.drag.mDown=!1,l)h.shortcutCutOutFromDrawer(c)&&(h.shortcuts.push(c),h.shortcuts[r].children.splice(o,1));else{var n,i=p(o);if(i.insert)if(i.id>o)for(var s=i.id-o;0<s;s--)Yuri2.arrDownRecord(h.shortcuts,i.id-s);else for(s=o-i.id;1<s;s--)Yuri2.arrUpRecord(h.shortcuts,i.id+s);i.over&&(n=h.shortcuts[i.id],c.children||n.children?!c.children&&n.children?(n.children.push(c),h.shortcuts.splice(o,1)):c.children&&!n.children?(c.children.push(n),h.shortcuts[i.id]=c,h.shortcuts.splice(o,1)):c.children&&n.children&&(c.children.forEach(function(t){n.children.push(t)}),h.shortcuts.splice(o,1)):(h.$set(h.shortcuts,i.id,{title:YL.lang("IconGroup")+YL.util.getID(),drag:{mDown:!1,left:0,top:0,x:0,y:0},children:[n,c]}),h.shortcuts.splice(o,1)))}c.drag.moved<20&&Date.now()-u<300&&h.shortcutOpen(c,o),c.drag.moved=0,c.drag.left=c.drag.top=0,h.runtime.shortcutInsert=h.runtime.shortcutOver=null,a?($(document).unbind("mousemove",d),$(document).unbind("mouseup",t)):($(document).unbind("touchmove",d),$(document).unbind("touchend",t))}},d=function(t){var e,n,i;c.drag.mDown&&(e=(i=s(t)).x,n=i.y,t=e-c.drag.x,i=n-c.drag.y,c.drag.left+=t,c.drag.top+=i,c.drag.x=e,c.drag.y=n,c.drag.moved+=Math.abs(t)+Math.abs(i),(i=p(o)).insert?h.runtime.shortcutInsert=i.id:h.runtime.shortcutInsert=null,i.over?h.runtime.shortcutOver=i.id:h.runtime.shortcutOver=null)},a?($(document).mouseup(t),$(document).mousemove(d)):($(document).on("touchend",t),$(document).on("touchmove",d)))},shortcutCutOutFromDrawer:function(t){return Math.abs(t.drag.left)+Math.abs(t.drag.top)>1.5*this.runtime.shortcutWidth},shortcutContextMenu:function(e,n,t,i){var s,o=this,r=(null===n?o.shortcuts:o.shortcuts[n].children)[e],a=[];r.children?a.push([YL.util.getStrFa("play-circle")+YL.lang("Open"),function(t){o.shortcutOpen(r,e)}]):a.push(o.contextMenuOpen(r)),a.push("|"),r.children?(a.push([YL.util.getStrFa("tags")+YL.lang("Rename"),function(){o.shortSetting=r},!YL.static.changeable]),a.push([YL.util.getStrFa("sitemap")+YL.lang("UnGroup"),function(t){r.children.forEach(function(t){o.shortcuts.splice(e+1,0,t)}),o.shortcuts.splice(e,1)},!YL.static.changeable])):(s=Yuri2.jsonDeepCopy({title:r.title,hash:r.hash,params:r.params,app:r.app,style:r.style}),a.push(o.contextMenuAddTo(s)),a.push([YL.util.getStrFa("tags")+YL.lang("Rename")+"/"+YL.lang("Options"),function(t){o.shortSetting=r},!YL.static.changeable])),r.app&&o.apps[r.app].badge&&a.push([YL.util.getStrFa("map-pin")+YL.lang("ClearSuperscript"),function(){o.apps[r.app].badge=0},!YL.static.changeable]),a.push("|"),a.push([YL.util.getStrFa("remove")+YL.lang("Delete"),function(t){YL.util.simpleConfirm(Yuri2.template(YL.lang("DeleteIconConfirm"),r.title),function(){(i?o.shortcuts[n].children:o.shortcuts).splice(e,1)})},!YL.static.changeable]),r.app&&a.push(o.contextMenuUninstall(r.app)),ContextMenu.render(t,a,this,"light")},shortcutGetDrawerBadge:function(t){var e,n=this.shortcuts[t].children,i=0;for(e in n){var s=n[e],s=parseInt(this.apps[s.app].badge);i+=s=isNaN(s)?1:s}return i},menuItemClick:function(t){this.appOpen(t.app,t,t)},msgClose:function(t){this.center.msg[t].hide=!0,this.$delete(this.center.msg,t),this.center.msgNum--},btnCenterClick:function(){this.center.open?this.hideOpens():(this.hideOpens(),this.center.open=!0,this.center.unread=0)},btnCenterClear:function(){var t,e=this;for(t in e.center.msg)e.center.msg[t].hide=!0;e.$set(e.center,"msg",{}),setTimeout(function(){e.center.unread=0,e.center.msgNum=0},500),setTimeout(function(){e.center.open=!1},1500)},barContextMenu:function(t){var e=this,n=[[YL.util.getStrFa("window-minimize")+YL.lang("HideAll"),function(){e.winHideAll()}],[YL.util.getStrFa("clone")+YL.lang("DisplayAll"),function(){e.winShowAll()}],[YL.util.getStrFa("window-close")+YL.lang("CloseAll"),function(){e.winCloseAll()}],"|"];e.configs.topTaskBar?n.push([YL.util.getStrFa("arrow-down")+YL.lang("BottomTaskBar"),function(){e.configs.topTaskBar=!1}],!YL.static.changeable):n.push([YL.util.getStrFa("arrow-up")+YL.lang("TopTaskBar"),function(){e.configs.topTaskBar=!0}]),ContextMenu.render(t,n,this)},tileContextMenu:function(n,i,t){var s,o=this,r=o.tiles[n].data[i],e=Yuri2.jsonDeepCopy({title:r.title,hash:r.hash,params:r.params,app:r.app,style:r.style}),e=[o.contextMenuOpen(r),o.contextMenuAddTo(e),[YL.util.getStrFa("tags")+YL.lang("Rename")+"/"+YL.lang("Options"),function(t){o.shortSetting=r},!YL.static.changeable],"|",[YL.util.getStrFa("braille")+YL.lang("Small")+YL.lang("Size"),function(){r.w=1,r.h=1},!YL.static.changeable],[YL.util.getStrFa("braille")+YL.lang("Middle")+YL.lang("Size"),function(){r.w=2,r.h=2},!YL.static.changeable],[YL.util.getStrFa("braille")+YL.lang("Big")+YL.lang("Size"),function(){r.w=4,r.h=4},!YL.static.changeable]];1<o.tiles.length&&(s=[],o.tiles.forEach(function(t,e){e!==n&&s.push([o.tiles[e].title,function(){o.tiles[n].data.splice(i,1);var t=Yuri2.jsonDeepCopy(r);t.y=999,t.x=0,o.tiles[e].data.push(t)},!YL.static.changeable])}),e.push([YL.util.getStrFa("cut")+YL.lang("MoveTo"),s])),e.push("|"),e.push([YL.util.getStrFa("remove")+YL.lang("Delete"),function(){YL.util.simpleConfirm(Yuri2.template(YL.lang("DeleteTileConfirm"),r.title),function(){o.tiles[n].data.splice(i,1)})},!YL.static.changeable]),e.push(o.contextMenuUninstall(r.app)),ContextMenu.render(t,e,this)},tileSrcCustom:function(t){return t.urlRandomToken?YL.util.updateUrlRandomToken(t.customTile,"",this.runtime.customTileRandomToken):t.customTile},menuContextMenu:function(t){var r=this,i=t.item,e=Yuri2.jsonDeepCopy({title:i.title,hash:i.hash,params:i.params,app:i.app,style:i.style}),a=t.id,n=[];i.app&&!i.children?n=[r.contextMenuOpen(i),r.contextMenuAddTo(e),[YL.util.getStrFa("tags")+YL.lang("Rename")+"/"+YL.lang("Options"),function(t){r.shortSetting=i},!YL.static.changeable]]:(n.push([YL.util.getStrFa("object-group")+YL.lang("NewSubgroup"),function(){var t={title:YL.lang("Group"),children:{},open:!0};r.setWithID(i.children,t,"itemPushed-")},!YL.static.changeable]),n.push([YL.util.getStrFa("tags")+YL.lang("Rename"),function(){r.shortSetting=i},!YL.static.changeable])),n.push("|"),n.push([YL.util.getStrFa("cut")+YL.lang("CutAndExchange"),function(){r.runtime.menuItemCut=a,YL.util.simpleMsg(i.title+" "+YL.lang("Recorded"))},!YL.static.changeable]),r.runtime.menuItemCut&&(n.push([YL.util.getStrFa("paste")+YL.lang("Paste"),function(){var n=r.runtime.menuItemCut;r.menuItemAction(n,function(t,e){e.children?r.$delete(e.children,n):r.$delete(e,n),r.$set(i.children,n,t)}),r.runtime.menuItemCut=null},!YL.static.changeable]),n.push([YL.util.getStrFa("exchange")+YL.lang("Exchange"),function(){var n,i,s,o,t=a,e=r.runtime.menuItemCut;r.menuItemAction(t,function(t,e){n=t,i=e}),r.menuItemAction(e,function(t,e){s=t,o=e}),r.runtime.menuItemCut=null;try{i[t]=s,o[e]=n}catch(t){}},!YL.static.changeable])),n.push("|"),n.push([YL.util.getStrFa("remove")+YL.lang("Delete"),function(){YL.util.simpleConfirm(Yuri2.template(YL.lang("DeleteMenuConfirm"),i.title),function(){r.menuItemAction(a,function(t,e){e.children?r.$delete(e.children,a):r.$delete(e,a)})})},!YL.static.changeable]),i.app&&n.push(r.contextMenuUninstall(i.app)),ContextMenu.render(t.event,n,this)},menuMainContextMenu:function(t){var i=this,e=[[YL.util.getStrFa("object-group")+YL.lang("NewSubgroup"),function(){var t={title:YL.lang("Group"),children:{},open:!0};i.setWithID(i.startMenu.menu,t,"itemPushed-")},!YL.static.changeable],[YL.util.getStrFa("paste")+YL.lang("Paste"),function(){var n=i.runtime.menuItemCut;i.menuItemAction(n,function(t,e){e.children?i.$delete(e.children,n):i.$delete(e,n),i.$set(i.startMenu.menu,n,t)}),i.runtime.menuItemCut=null},!YL.static.changeable]];ContextMenu.render(t,e,this)},menuItemAction:function(t,e,n){var i,s=n?n.children:this.startMenu.menu;for(i in s){var o=s[i];i===t?e(o,s):o.children&&this.menuItemAction(t,e,o)}},tilesBoxContextMenu:function(t){var e=[[YL.util.getStrFa("object-group")+YL.lang("NewSubgroup"),function(){YL.addTileGroup()}],!YL.static.changeable];ContextMenu.render(t,e,this)},backgroundToThemeColor:function(){var e=this;YL.util.imgUrlToThemeColor(this.runtime.wallpaper,function(t){e.configs.themeColor=t},.6)},backgroundUpdateScale:function(){var n=this,t=this.configs.wallpaper;YL.util.imgUrlToSize(t,function(t){var e=t.width||1,t=t.height||1;n.runtime.wallpaperScale=e/t})},sidebarBtnContextMenu:function(t,e){var n=this,i=n.startMenu.sidebar.btns[t],s=Yuri2.jsonDeepCopy({title:i.title,hash:i.hash,params:i.params,app:i.app,style:i.style}),s=[n.contextMenuOpen(i),n.contextMenuAddTo(s),[YL.util.getStrFa("tags")+YL.lang("Rename")+"/"+YL.lang("Options"),function(t){n.shortSetting=i},!YL.static.changeable],"|",[YL.util.getStrFa("arrow-up")+YL.lang("ShiftUp"),function(){Yuri2.arrUpRecord(n.startMenu.sidebar.btns,t)},!YL.static.changeable],[YL.util.getStrFa("arrow-down")+YL.lang("ShiftDown"),function(){Yuri2.arrDownRecord(n.startMenu.sidebar.btns,t)},!YL.static.changeable],"|",[YL.util.getStrFa("remove")+YL.lang("Delete"),function(){YL.util.simpleConfirm(Yuri2.template(YL.lang("DeleteBtnConfirm"),i.title),function(){n.startMenu.sidebar.btns.splice(t,1)})},!YL.static.changeable],n.contextMenuUninstall(i.app)];ContextMenu.render(e,s,this)},tilesTitleContextMenu:function(t,e){var n=this,i=n.tiles[t],s=[[YL.util.getStrFa("tags")+YL.lang("Rename"),function(){n.shortSetting=i},!YL.static.changeable],[YL.util.getStrFa("arrow-up")+YL.lang("ShiftUp"),function(){Yuri2.arrUpRecord(n.tiles,t)},!YL.static.changeable],[YL.util.getStrFa("arrow-down")+YL.lang("ShiftDown"),function(){Yuri2.arrDownRecord(n.tiles,t)},!YL.static.changeable],[YL.util.getStrFa("remove")+YL.lang("Delete"),function(){YL.util.simpleConfirm(Yuri2.template(YL.lang("DeleteGroupConfirm"),i.title),function(){n.tiles.splice(t,1)})},!YL.static.changeable]];ContextMenu.render(e,s,this)},tileMoved:function(){this.runtime.tileMoved=!0},tileMouseDown:function(t){var i=this,s=t.pageX,o=t.pageY,t=function t(e){var n=e.pageX,e=e.pageY;5<Math.abs(n-s)+Math.abs(e-o)&&(i.runtime.tileMoved=!0),$(document).unbind("mouseup",t)};$(document).on("mouseup",t)},tileClick:function(t){this.runtime.tileMoved||this.appOpen(t.app,t,t),this.runtime.tileMoved=!1},btnShortSettingAdvanceClick:function(t){this.shortSetting=null,YL.open("yl-system",{data:{appSetting:t}})},shortSettingParamsAdd:function(){this.runtime.shortcutNewParamName&&this.runtime.shortcutNewParamValue&&(this.shortSetting.params||this.$set(this.shortSetting,"params",{}),this.$set(this.shortSetting.params,this.runtime.shortcutNewParamName,this.runtime.shortcutNewParamValue),this.runtime.shortcutNewParamName="",this.runtime.shortcutNewParamValue="")},shortSettingParamsDelete:function(t){this.$delete(this.shortSetting.params,t)},startMenuResizeMouseDown:function(t){var n=this,i=n.runtime.startMenu;i.drag.x=t.pageX,i.drag.y=t.pageY,i.drag.mDown=!0;var t=function t(e){i.drag.mDown&&(i.drag.mDown=!1,$(document).unbind("mouseup",t),$(document).unbind("mousemove",s))},s=function(t){var e;i.drag.mDown&&(e=t.pageX,t=t.pageY,n.startMenu.width+=e-i.drag.x,320<n.startMenu.width||(n.startMenu.width=320),n.startMenu.height-=(n.configs.topTaskBar?-1:1)*(t-i.drag.y),160<n.startMenu.height||(n.startMenu.height=160),i.drag.x=e,i.drag.y=t,n.onResize())};$(document).mouseup(t),$(document).mousemove(s)}},watch:{shortSetting:{handler:function(t,e){t&&(this.drawer=null)}},"configs.wallpaper":{handler:function(t,e){var n=this,i=new Image;i.src=t,i.onload=function(){n.runtime.wallpaper=t,n.configs.autoThemeColor&&n.backgroundToThemeColor()},n.backgroundUpdateScale()}},wins:{handler:function(t,e){var n,i=0;for(n in this.wins)this.wins[n].plugin||i++;this.runtime.winOpened=i}},"startMenu.open":{handler:function(t,e){t&&this.$nextTick(YL.util.artificiallyResize)}},"startMenu.menu":{handler:function(t,e){this.$nextTick(YL.util.artificiallyResize)}}},computed:{smallScreenAndMenuOpend:function(){return this.runtime.isSmallScreen&&this.startMenu.open},tilesBoxStyle:function(){var t,e=this.runtime.clientSize.width;return this.runtime.isSmallScreen&&(t=48+(this.runtime.menuOnLeft?e:0)),{left:this.runtime.isSmallScreen?t+"px":"312px"}},menuStyle:function(){var t=this.runtime.clientSize.width;return this.runtime.isSmallScreen?{left:48+(this.runtime.menuOnLeft?0:-t)+"px"}:{}},barStyle:function(){if(this.configs.topTaskBar)return{top:0,bottom:"none"}},centerStyle:function(){return this.configs.topTaskBar?{top:"40px"}:{bottom:"40px"}},backgroundCross:function(){var t=this.runtime;return t.wallpaperScale<t.clientSize.width/t.clientSize.height}}})};